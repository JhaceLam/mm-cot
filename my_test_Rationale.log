args Namespace(bs=8, caption_file='data/instruct_captions.json', data_root='data', epoch=20, eval_acc=4, eval_bs=4, eval_le=None, evaluate_dir='models/MM-CoT-UnifiedQA-base-Rationale', final_eval=True, img_type='detr', input_len=512, lr=5e-05, model='allenai/unifiedqa-t5-base', options=['A', 'B', 'C', 'D', 'E'], output_dir='experiments', output_len=512, prompt_format='QCM-LE', seed=42, test_le=None, test_split='test', train_split='train', use_caption=False, use_generate=False, user_msg='rationale', val_split='val')
====Input Arguments====
{
  "data_root": "data",
  "output_dir": "experiments",
  "model": "allenai/unifiedqa-t5-base",
  "options": [
    "A",
    "B",
    "C",
    "D",
    "E"
  ],
  "epoch": 20,
  "lr": 5e-05,
  "bs": 8,
  "input_len": 512,
  "output_len": 512,
  "eval_bs": 4,
  "eval_acc": 4,
  "train_split": "train",
  "val_split": "val",
  "test_split": "test",
  "use_generate": false,
  "final_eval": true,
  "user_msg": "rationale",
  "img_type": "detr",
  "eval_le": null,
  "test_le": null,
  "evaluate_dir": "models/MM-CoT-UnifiedQA-base-Rationale",
  "caption_file": "data/instruct_captions.json",
  "use_caption": false,
  "prompt_format": "QCM-LE",
  "seed": 42
}
img_features size:  (11208, 100, 256)
number of train problems: 12726

number of val problems: 4241

number of test problems: 4241

[12:26:32] [Model]: Loading models/MM-CoT-UnifiedQA-base-Rationale...                                                                                                                                                                main.py:68
                                                                                                                                                                                                                                               
           [Data]: Reading data...                                                                                                                                                                                                   main.py:69
                                                                                                                                                                                                                                               
model parameters:  226643712
  0%|          | 0/531 [00:00<?, ?it/s]  0%|          | 2/531 [00:00<01:13,  7.16it/s]  1%|          | 3/531 [00:00<01:41,  5.18it/s]  1%|          | 4/531 [00:00<01:58,  4.46it/s]  1%|          | 5/531 [00:02<06:57,  1.26it/s]  1%|          | 6/531 [00:02<05:26,  1.61it/s]  1%|▏         | 7/531 [00:03<04:27,  1.96it/s]  2%|▏         | 8/531 [00:03<03:46,  2.30it/s]  2%|▏         | 9/531 [00:09<18:44,  2.15s/it]  2%|▏         | 10/531 [00:09<13:40,  1.57s/it]  2%|▏         | 11/531 [00:10<10:46,  1.24s/it]  2%|▏         | 12/531 [00:10<08:12,  1.05it/s]  2%|▏         | 13/531 [00:16<21:51,  2.53s/it]  3%|▎         | 14/531 [00:16<15:53,  1.84s/it]  3%|▎         | 15/531 [00:17<11:47,  1.37s/it]  3%|▎         | 16/531 [00:17<08:54,  1.04s/it]  3%|▎         | 17/531 [00:28<34:05,  3.98s/it]  3%|▎         | 18/531 [00:28<24:27,  2.86s/it]  4%|▎         | 19/531 [00:28<17:42,  2.07s/it]  4%|▍         | 20/531 [00:29<13:00,  1.53s/it]  4%|▍         | 21/531 [00:41<41:16,  4.86s/it]  4%|▍         | 22/531 [00:41<29:29,  3.48s/it]  4%|▍         | 23/531 [00:42<21:14,  2.51s/it]  5%|▍         | 24/531 [00:42<15:27,  1.83s/it]  5%|▍         | 25/531 [00:56<47:03,  5.58s/it]  5%|▍         | 26/531 [00:57<33:28,  3.98s/it]  5%|▌         | 27/531 [00:57<24:03,  2.86s/it]  5%|▌         | 28/531 [00:57<17:28,  2.08s/it]  5%|▌         | 29/531 [01:13<52:50,  6.32s/it]  6%|▌         | 30/531 [01:13<37:31,  4.49s/it]  6%|▌         | 31/531 [01:14<26:49,  3.22s/it]  6%|▌         | 32/531 [01:14<19:20,  2.33s/it]  6%|▌         | 33/531 [01:28<48:15,  5.81s/it]  6%|▋         | 34/531 [01:28<34:18,  4.14s/it]  7%|▋         | 35/531 [01:28<24:35,  2.97s/it]  7%|▋         | 36/531 [01:29<17:47,  2.16s/it]  7%|▋         | 37/531 [01:45<51:45,  6.29s/it]  7%|▋         | 38/531 [01:45<36:47,  4.48s/it]  7%|▋         | 39/531 [01:45<26:19,  3.21s/it]  8%|▊         | 40/531 [01:45<19:00,  2.32s/it]  8%|▊         | 41/531 [02:01<52:24,  6.42s/it]  8%|▊         | 42/531 [02:02<37:13,  4.57s/it]  8%|▊         | 43/531 [02:02<26:36,  3.27s/it]  8%|▊         | 44/531 [02:02<19:14,  2.37s/it]  8%|▊         | 45/531 [02:25<1:09:24,  8.57s/it]  9%|▊         | 46/531 [02:25<49:06,  6.08s/it]    9%|▉         | 47/531 [02:26<34:55,  4.33s/it]  9%|▉         | 48/531 [02:26<25:01,  3.11s/it]  9%|▉         | 49/531 [02:53<1:21:55, 10.20s/it]  9%|▉         | 50/531 [02:53<57:50,  7.22s/it]   10%|▉         | 51/531 [02:53<40:58,  5.12s/it] 10%|▉         | 52/531 [02:53<29:16,  3.67s/it] 10%|▉         | 53/531 [03:22<1:29:59, 11.30s/it] 10%|█         | 54/531 [03:23<1:03:28,  7.98s/it] 10%|█         | 55/531 [03:23<44:57,  5.67s/it]   11%|█         | 56/531 [03:23<32:05,  4.05s/it] 11%|█         | 57/531 [03:52<1:30:20, 11.43s/it] 11%|█         | 58/531 [03:52<1:03:42,  8.08s/it] 11%|█         | 59/531 [03:52<45:08,  5.74s/it]   11%|█▏        | 60/531 [03:53<32:09,  4.10s/it] 11%|█▏        | 61/531 [04:22<1:31:11, 11.64s/it] 12%|█▏        | 62/531 [04:22<1:04:20,  8.23s/it] 12%|█▏        | 63/531 [04:23<45:32,  5.84s/it]   12%|█▏        | 64/531 [04:23<32:52,  4.22s/it] 12%|█▏        | 65/531 [04:58<1:44:50, 13.50s/it] 12%|█▏        | 66/531 [04:58<1:13:49,  9.53s/it] 13%|█▎        | 67/531 [04:59<52:08,  6.74s/it]   13%|█▎        | 68/531 [04:59<37:01,  4.80s/it] 13%|█▎        | 69/531 [05:29<1:35:18, 12.38s/it] 13%|█▎        | 70/531 [05:29<1:07:11,  8.75s/it] 13%|█▎        | 71/531 [05:29<47:30,  6.20s/it]   14%|█▎        | 72/531 [05:30<33:51,  4.43s/it] 14%|█▎        | 73/531 [06:02<1:37:18, 12.75s/it] 14%|█▍        | 74/531 [06:02<1:08:31,  9.00s/it] 14%|█▍        | 75/531 [06:02<48:30,  6.38s/it]   14%|█▍        | 76/531 [06:03<34:28,  4.55s/it] 15%|█▍        | 77/531 [06:31<1:29:07, 11.78s/it] 15%|█▍        | 78/531 [06:32<1:02:49,  8.32s/it] 15%|█▍        | 79/531 [06:32<44:29,  5.91s/it]   15%|█▌        | 80/531 [06:32<31:40,  4.21s/it] 15%|█▌        | 81/531 [07:12<1:50:44, 14.76s/it] 15%|█▌        | 82/531 [07:12<1:17:54, 10.41s/it] 16%|█▌        | 83/531 [07:12<54:57,  7.36s/it]   16%|█▌        | 84/531 [07:12<38:56,  5.23s/it] 16%|█▌        | 85/531 [07:56<2:04:49, 16.79s/it] 16%|█▌        | 86/531 [07:56<1:27:45, 11.83s/it] 16%|█▋        | 87/531 [07:57<1:01:54,  8.37s/it] 17%|█▋        | 88/531 [07:57<43:50,  5.94s/it]   17%|█▋        | 89/531 [08:46<2:19:20, 18.92s/it] 17%|█▋        | 90/531 [08:46<1:37:51, 13.32s/it] 17%|█▋        | 91/531 [08:47<1:08:56,  9.40s/it] 17%|█▋        | 92/531 [08:47<49:10,  6.72s/it]   18%|█▊        | 93/531 [09:34<2:17:25, 18.83s/it] 18%|█▊        | 94/531 [09:34<1:36:31, 13.25s/it] 18%|█▊        | 95/531 [09:35<1:07:57,  9.35s/it] 18%|█▊        | 96/531 [09:35<48:01,  6.62s/it]   18%|█▊        | 97/531 [10:25<2:22:58, 19.77s/it] 18%|█▊        | 98/531 [10:26<1:40:23, 13.91s/it] 19%|█▊        | 99/531 [10:26<1:10:48,  9.83s/it] 19%|█▉        | 100/531 [10:26<49:58,  6.96s/it]  19%|█▉        | 101/531 [11:18<2:26:42, 20.47s/it] 19%|█▉        | 102/531 [11:18<1:43:02, 14.41s/it] 19%|█▉        | 103/531 [11:19<1:12:30, 10.17s/it] 20%|█▉        | 104/531 [11:19<51:12,  7.20s/it]   20%|█▉        | 105/531 [12:05<2:14:26, 18.94s/it] 20%|█▉        | 106/531 [12:05<1:34:25, 13.33s/it] 20%|██        | 107/531 [12:06<1:06:27,  9.41s/it] 20%|██        | 108/531 [12:06<46:56,  6.66s/it]   21%|██        | 109/531 [13:01<2:28:20, 21.09s/it] 21%|██        | 110/531 [13:01<1:44:09, 14.84s/it] 21%|██        | 111/531 [13:01<1:13:18, 10.47s/it] 21%|██        | 112/531 [13:02<51:44,  7.41s/it]   21%|██▏       | 113/531 [14:00<2:37:43, 22.64s/it] 21%|██▏       | 114/531 [14:00<1:50:39, 15.92s/it] 22%|██▏       | 115/531 [14:00<1:17:46, 11.22s/it] 22%|██▏       | 116/531 [14:00<54:52,  7.93s/it]   22%|██▏       | 117/531 [14:58<2:36:48, 22.73s/it] 22%|██▏       | 118/531 [14:58<1:50:17, 16.02s/it] 22%|██▏       | 119/531 [14:58<1:17:31, 11.29s/it] 23%|██▎       | 120/531 [14:59<54:37,  7.97s/it]   23%|██▎       | 121/531 [16:02<2:47:37, 24.53s/it] 23%|██▎       | 122/531 [16:02<1:57:33, 17.25s/it] 23%|██▎       | 123/531 [16:02<1:22:35, 12.15s/it] 23%|██▎       | 124/531 [16:03<58:11,  8.58s/it]   24%|██▎       | 125/531 [17:08<2:53:05, 25.58s/it] 24%|██▎       | 126/531 [17:08<2:01:24, 17.99s/it] 24%|██▍       | 127/531 [17:08<1:25:18, 12.67s/it] 24%|██▍       | 128/531 [17:09<1:00:06,  8.95s/it] 24%|██▍       | 129/531 [18:08<2:41:51, 24.16s/it] 24%|██▍       | 130/531 [18:08<1:53:30, 16.98s/it] 25%|██▍       | 131/531 [18:09<1:19:47, 11.97s/it] 25%|██▍       | 132/531 [18:09<56:11,  8.45s/it]   25%|██▌       | 133/531 [19:19<2:59:24, 27.05s/it] 25%|██▌       | 134/531 [19:20<2:05:45, 19.01s/it] 25%|██▌       | 135/531 [19:20<1:28:17, 13.38s/it] 26%|██▌       | 136/531 [19:20<1:02:11,  9.45s/it] 26%|██▌       | 137/531 [20:30<3:01:07, 27.58s/it] 26%|██▌       | 138/531 [20:30<2:06:56, 19.38s/it] 26%|██▌       | 139/531 [20:31<1:29:09, 13.65s/it] 26%|██▋       | 140/531 [20:31<1:02:45,  9.63s/it] 27%|██▋       | 141/531 [21:34<2:47:47, 25.82s/it] 27%|██▋       | 142/531 [21:35<1:57:38, 18.14s/it] 27%|██▋       | 143/531 [21:35<1:22:36, 12.77s/it] 27%|██▋       | 144/531 [21:35<58:08,  9.02s/it]   27%|██▋       | 145/531 [22:44<2:53:37, 26.99s/it] 27%|██▋       | 146/531 [22:44<2:01:41, 18.96s/it] 28%|██▊       | 147/531 [22:45<1:25:25, 13.35s/it] 28%|██▊       | 148/531 [22:45<1:00:06,  9.42s/it] 28%|██▊       | 149/531 [23:59<3:04:28, 28.98s/it] 28%|██▊       | 150/531 [24:00<2:09:15, 20.36s/it] 28%|██▊       | 151/531 [24:00<1:30:44, 14.33s/it] 29%|██▊       | 152/531 [24:00<1:03:51, 10.11s/it] 29%|██▉       | 153/531 [25:14<3:04:09, 29.23s/it] 29%|██▉       | 154/531 [25:14<2:09:02, 20.54s/it] 29%|██▉       | 155/531 [25:15<1:30:32, 14.45s/it] 29%|██▉       | 156/531 [25:15<1:03:41, 10.19s/it] 30%|██▉       | 157/531 [26:26<2:58:22, 28.62s/it] 30%|██▉       | 158/531 [26:27<2:04:59, 20.11s/it] 30%|██▉       | 159/531 [26:27<1:27:42, 14.15s/it] 30%|███       | 160/531 [26:27<1:01:39,  9.97s/it] 30%|███       | 161/531 [27:42<3:01:46, 29.48s/it] 31%|███       | 162/531 [27:42<2:07:24, 20.72s/it] 31%|███       | 163/531 [27:43<1:29:25, 14.58s/it] 31%|███       | 164/531 [27:43<1:02:54, 10.29s/it] 31%|███       | 165/531 [28:53<2:52:59, 28.36s/it] 31%|███▏      | 166/531 [28:54<2:01:15, 19.93s/it] 31%|███▏      | 167/531 [28:54<1:25:09, 14.04s/it] 32%|███▏      | 168/531 [28:54<59:57,  9.91s/it]   32%|███▏      | 169/531 [30:22<3:21:22, 33.38s/it] 32%|███▏      | 170/531 [30:23<2:21:03, 23.45s/it] 32%|███▏      | 171/531 [30:23<1:38:57, 16.49s/it] 32%|███▏      | 172/531 [30:23<1:09:34, 11.63s/it]Killed
